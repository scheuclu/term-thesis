%%
%% This is file `AMlayout.sty',
%% generated with the docstrip utility.
%%
%% The original source files were:
%%
%% AMlayout.dtx  (with options: `package')
%% --------------------------------------------------------------------------------
%% AMlayout <!AMreleaseVersion!> --- Package of the AMlatex-Bundle for page layout
%% E-mail: romain.pennec@tum.de
%% Released under the LaTeX Project Public License v1.3c or later
%% See http://www.latex-project.org/lppl.txt
%% --------------------------------------------------------------------------------
%% 
\RequirePackage{AMgit}
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{AMlayout}[\AMinsertGitDate{} \AMinsertGitVersion{} AM page layout]
\RequirePackage{ifthen}
\RequirePackage{kvoptions}
\RequirePackage{pgfopts}
\RequirePackage{pgfkeys}
\providecommand{\AMset}[1]{\pgfkeys{/AM/.cd,#1}}
\newcommand{\AMsetLayout}[1]{\pgfkeys{/AM/layout/.cd,#1}}
\DeclareStringOption[0pt]{headrulewidth}
\DeclareStringOption[0pt]{footrulewidth}
\pgfkeys{
  /AM/layout/.is family,/AM/layout,
  page geometry/.code = {\geometry{#1}},
  a4default/.style = {%
    page geometry={left=35mm,right=25mm,top=25mm,bottom=25mm},%
    page geometry={headheight=15pt,headsep=5mm},%
  },
  page style/.code = {\pagestyle{#1}},
  setup chapter page/.code = {\AMlayout@setup@cleardoublepage\AMlayout@setup@plainpage},
}
\RequirePackage[a4paper]{geometry}
\ProcessPgfOptions{AM/layout}
\providecommand{\AMfont@pagenumber@style}{\@empty}
\providecommand{\AMfont@leftmark@style}{\@empty}
\providecommand{\AMfont@rightmark@style}{\@empty}
\newcommand{\AMlayout@setup@penalties}{
  \clubpenalty=300
  \widowpenalty=400
  \displaywidowpenalty=300
  \brokenpenalty=400
  \relpenalty=700
  \binoppenalty=2000
  \interdisplaylinepenalty=2500
}
\RequirePackage{titlesec}
\newcommand{\AMlayout@setup@titlespacing}{%
  \titlespacing*{\chapter}{0pt}{50pt}{40pt}
  \titlespacing*{\section}{0pt}{3.5ex plus 1ex minus .2ex}{2.3ex plus .2ex}
  \titlespacing*{\subsection}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
  \titlespacing*{\subsubsection}{0pt}{3.25ex plus 1ex minus .2ex}{1.5ex plus .2ex}
  \titlespacing*{\paragraph}{0pt}{3.25ex plus 1ex minus .2ex}{1em}
  \titlespacing*{\subparagraph}{\parindent}{3.25ex plus 1ex minus .2ex}{1em}
}
\RequirePackage{fancyhdr}
\newcommand{\AMlayout@setup@cleardoublepage}{
  \renewcommand{\cleardoublepage}{%
    \clearpage\ifodd\c@page\else
    \hbox{}
    \vspace*{\fill}
    \thispagestyle{empty}%
    \newpage
    \fi%
  }
}
\newcommand{\AMlayout@setup@plainpage}{%
  \fancypagestyle{plain}{%
    \fancyhf{}%
    \fancyfoot[C]{\AMfont@pagenumber@style\thepage}%
    \renewcommand{\headrulewidth}{0pt}%
    \renewcommand{\footrulewidth}{0pt}%
  }
}
\newcommand{\AMlayout@init@matter}{%
  \newif\if@mainmatter
  \newif\if@frontmatter
  \def\frontmatter{}
  \def\mainmatter{}
  \def\backmatter{}
  \AMlayout@setup@frontmatter
  \AMlayout@setup@mainmatter
  \AMlayout@setup@backmatter
}
\newcommand{\AMlayout@setup@frontmatter}{%
  \renewcommand{\frontmatter}{%
    \cleardoublepage%
    \@frontmattertrue%
    \@mainmatterfalse%
    \pagenumbering{roman}
  }
}
\newcommand{\AMlayout@setup@mainmatter}{%
  \renewcommand{\mainmatter}{%
    \cleardoublepage%
    \@mainmattertrue%
    \@frontmatterfalse%
    \pagenumbering{arabic}
  }
}
\newcommand{\AMlayout@setup@backmatter}{%
  \renewcommand{\backmatter}{%
    \cleardoublepage%
    \@frontmatterfalse%
    \@mainmatterfalse%
  }
}
\fancypagestyle{AMdissps}{%
  \AtBeginDocument{%
    \renewcommand{\sectionmark}[1]{\markright{\thesection\ ##1}}
    \renewcommand{\chaptermark}[1]{\markboth{##1}{}}
  }%
  \fancyhf{}
  \fancyhead[LE,RO]{\AMfont@pagenumber@style\thepage}
  \fancyhead[LO]{\AMfont@rightmark@style\rightmark}
  \fancyhead[RE]{\AMfont@leftmark@style\leftmark}
  \renewcommand{\headrulewidth}{\AMlayout@headrulewidth}
  \renewcommand{\footrulewidth}{\AMlayout@footrulewidth}
}
\fancypagestyle{AMscriptumps}{%
  \fancyhf{}
  \fancyhead[LE,RO]{\AMfont@pagenumber@style\thepage}
  \fancyhead[LO]{\AMfont@rightmark@style\rightmark}
  \fancyhead[RE]{\AMfont@leftmark@style\leftmark}
  \renewcommand{\headrulewidth}{\AMlayout@headrulewidth}
  \renewcommand{\footrulewidth}{\AMlayout@footrulewidth}
}
%% 
%% Copyright (C) 2003-2010 by S. Lohmeier <lohmeier@amm.mw.tum.de>
%% Copyright (C) 2011-2013 by M. Schwienbacher <m.schwienbacher@tum.de>
%% Copyright (C) 2014 by K. Grundl <kilian.grundl@tum.de>
%% Copyright (C) 2015-2016 by R. Pennec <romain.pennec@tum.de>
%% 
%% This work may be distributed and/or modified under the
%% conditions of the LaTeX Project Public License (LPPL), either
%% version 1.3c of this license or (at your option) any later
%% version.  The latest version of this license is in the file:
%% 
%% http://www.latex-project.org/lppl.txt
%% 
%% This work is "maintained" (as per LPPL maintenance status) by
%% Romain Pennec.
%% 
%% This work consists of the file  AMlayout.dtx
%% and the derived files           AMlayout.ins,
%%                                 AMlayout.pdf and
%%                                 AMlayout.sty.
%% 
%%
%% End of file `AMlayout.sty'.
